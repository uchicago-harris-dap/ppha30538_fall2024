<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Peter Ganong and Maggie Shi">
<meta name="dcterms.date" content="2024-10-16">

<title>Visualization (Scales and Guides)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="scales_axes_legends_files/libs/clipboard/clipboard.min.js"></script>
<script src="scales_axes_legends_files/libs/quarto-html/quarto.js"></script>
<script src="scales_axes_legends_files/libs/quarto-html/popper.min.js"></script>
<script src="scales_axes_legends_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="scales_axes_legends_files/libs/quarto-html/anchor.min.js"></script>
<link href="scales_axes_legends_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="scales_axes_legends_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="scales_axes_legends_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="scales_axes_legends_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="scales_axes_legends_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#intro" id="toc-intro" class="nav-link active" data-scroll-target="#intro">Intro</a>
  <ul class="collapse">
  <li><a href="#roadmap" id="toc-roadmap" class="nav-link" data-scroll-target="#roadmap">roadmap</a></li>
  <li><a href="#scales-and-guides" id="toc-scales-and-guides" class="nav-link" data-scroll-target="#scales-and-guides">scales and guides</a></li>
  <li><a href="#dataset-for-this-lecture" id="toc-dataset-for-this-lecture" class="nav-link" data-scroll-target="#dataset-for-this-lecture">Dataset for this lecture</a></li>
  </ul></li>
  <li><a href="#configuring-scales-and-axes" id="toc-configuring-scales-and-axes" class="nav-link" data-scroll-target="#configuring-scales-and-axes">Configuring Scales and Axes</a>
  <ul class="collapse">
  <li><a href="#configuring-scales-and-axes-roadmap" id="toc-configuring-scales-and-axes-roadmap" class="nav-link" data-scroll-target="#configuring-scales-and-axes-roadmap">Configuring Scales and Axes: roadmap</a></li>
  <li><a href="#plotting-antibiotic-resistance-adjusting-the-scale-type" id="toc-plotting-antibiotic-resistance-adjusting-the-scale-type" class="nav-link" data-scroll-target="#plotting-antibiotic-resistance-adjusting-the-scale-type">Plotting Antibiotic Resistance: Adjusting the Scale Type</a></li>
  <li><a href="#alt-scale-i" id="toc-alt-scale-i" class="nav-link" data-scroll-target="#alt-scale-i">alt scale I</a></li>
  <li><a href="#alt-scale-ii" id="toc-alt-scale-ii" class="nav-link" data-scroll-target="#alt-scale-ii">alt scale II</a></li>
  <li><a href="#styling-an-axis" id="toc-styling-an-axis" class="nav-link" data-scroll-target="#styling-an-axis">Styling an Axis</a></li>
  <li><a href="#add-a-clarifying-title" id="toc-add-a-clarifying-title" class="nav-link" data-scroll-target="#add-a-clarifying-title">add a clarifying title</a></li>
  <li><a href="#comparing-antibiotics-adjusting-grid-lines-tick-counts-and-sizing" id="toc-comparing-antibiotics-adjusting-grid-lines-tick-counts-and-sizing" class="nav-link" data-scroll-target="#comparing-antibiotics-adjusting-grid-lines-tick-counts-and-sizing">Comparing Antibiotics: Adjusting Grid Lines, Tick Counts, and Sizing</a></li>
  <li><a href="#fix-domain-equalize-aspect-ratio" id="toc-fix-domain-equalize-aspect-ratio" class="nav-link" data-scroll-target="#fix-domain-equalize-aspect-ratio">fix <code>domain</code>, equalize aspect ratio</a></li>
  <li><a href="#reduce-grid-clutter-with-alt.axistickcount5" id="toc-reduce-grid-clutter-with-alt.axistickcount5" class="nav-link" data-scroll-target="#reduce-grid-clutter-with-alt.axistickcount5">reduce grid clutter with <code>alt.Axis(tickCount=5)</code></a></li>
  <li><a href="#configuring-scales-and-axes-summary" id="toc-configuring-scales-and-axes-summary" class="nav-link" data-scroll-target="#configuring-scales-and-axes-summary">Configuring Scales and Axes: summary</a></li>
  </ul></li>
  <li><a href="#configuring-color-legends" id="toc-configuring-color-legends" class="nav-link" data-scroll-target="#configuring-color-legends">Configuring Color Legends</a>
  <ul class="collapse">
  <li><a href="#configuring-color-legends-roadmap-and-warning" id="toc-configuring-color-legends-roadmap-and-warning" class="nav-link" data-scroll-target="#configuring-color-legends-roadmap-and-warning">Configuring Color Legends: roadmap and warning</a></li>
  <li><a href="#visualization-as-a-tool-for-discovery" id="toc-visualization-as-a-tool-for-discovery" class="nav-link" data-scroll-target="#visualization-as-a-tool-for-discovery">Visualization as a tool for discovery</a></li>
  <li><a href="#gram-staining" id="toc-gram-staining" class="nav-link" data-scroll-target="#gram-staining">Gram staining</a></li>
  <li><a href="#alt.colorgram_stainingn" id="toc-alt.colorgram_stainingn" class="nav-link" data-scroll-target="#alt.colorgram_stainingn">alt.Color(‘Gram_Staining:N’)</a></li>
  <li><a href="#sometimes-helpful-trick-choose-colors-with-external-meaning" id="toc-sometimes-helpful-trick-choose-colors-with-external-meaning" class="nav-link" data-scroll-target="#sometimes-helpful-trick-choose-colors-with-external-meaning">Sometimes helpful trick: choose colors with external meaning</a></li>
  <li><a href="#color-by-species-i" id="toc-color-by-species-i" class="nav-link" data-scroll-target="#color-by-species-i">Color by Species I</a></li>
  <li><a href="#color-by-species-ii" id="toc-color-by-species-ii" class="nav-link" data-scroll-target="#color-by-species-ii">Color by Species II</a></li>
  <li><a href="#color-by-species-iii-color-as-o" id="toc-color-by-species-iii-color-as-o" class="nav-link" data-scroll-target="#color-by-species-iii-color-as-o">Color by Species III – color as <code>O</code></a></li>
  <li><a href="#color-by-species-iv-use-viridis" id="toc-color-by-species-iv-use-viridis" class="nav-link" data-scroll-target="#color-by-species-iv-use-viridis">Color by Species IV – use <code>viridis</code></a></li>
  <li><a href="#discussion-questions" id="toc-discussion-questions" class="nav-link" data-scroll-target="#discussion-questions">Discussion questions</a></li>
  <li><a href="#text-labels-by-species" id="toc-text-labels-by-species" class="nav-link" data-scroll-target="#text-labels-by-species">Text Labels by Species</a></li>
  <li><a href="#color-by-genus-i" id="toc-color-by-genus-i" class="nav-link" data-scroll-target="#color-by-genus-i">Color by Genus I</a></li>
  <li><a href="#color-by-genus-ii" id="toc-color-by-genus-ii" class="nav-link" data-scroll-target="#color-by-genus-ii">Color by Genus II</a></li>
  <li><a href="#color-by-antibiotic-response-i" id="toc-color-by-antibiotic-response-i" class="nav-link" data-scroll-target="#color-by-antibiotic-response-i">Color by Antibiotic Response I</a></li>
  <li><a href="#color-by-antibiotic-response-ii" id="toc-color-by-antibiotic-response-ii" class="nav-link" data-scroll-target="#color-by-antibiotic-response-ii">Color by Antibiotic Response II</a></li>
  <li><a href="#configuring-color-legends-summary" id="toc-configuring-color-legends-summary" class="nav-link" data-scroll-target="#configuring-color-legends-summary">Configuring Color Legends: summary</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Visualization (Scales and Guides)</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Peter Ganong and Maggie Shi </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 16, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<!--
    beamer:
        echo: true
        eval: true
        aspectratio: 169
        theme: default
        toc: true
        header-includes: \renewcommand{\tightlist}{\setlength{\itemsep}{5ex}\setlength{\parskip}{0pt}}
            \setbeamertemplate{footline}[frame number] 
            -->
<section id="intro" class="level1">
<h1>Intro</h1>
<section id="roadmap" class="level2">
<h2 class="anchored" data-anchor-id="roadmap">roadmap</h2>
<ul>
<li>define scales and guides</li>
<li>load and explain dataset</li>
</ul>
<p>(no summary at end because slides are self-contained)</p>
</section>
<section id="scales-and-guides" class="level2">
<h2 class="anchored" data-anchor-id="scales-and-guides">scales and guides</h2>
<p>“Visual encoding mapping data to visual variables such as position, size, shape, or color is the beating heart of data visualization.”</p>
<p>Two steps:</p>
<ol type="1">
<li><em>scale</em>: a function that takes a data value as input (the scale <em>domain</em>) and returns a visual value, such as a pixel position or RGB color, as output (the scale <em>range</em>).</li>
<li><em>guide</em>: that allow readers to decode the graphic. Two types:
<ul>
<li><em>axes</em> which visualize scales with spatial ranges</li>
<li><em>legends</em> which visualize scales with color, size, or shape ranges</li>
</ul></li>
</ol>
</section>
<section id="dataset-for-this-lecture" class="level2">
<h2 class="anchored" data-anchor-id="dataset-for-this-lecture">Dataset for this lecture</h2>
<ul>
<li>Each row: a type of bacteria</li>
<li>Each column: a type of antibiotic</li>
<li>Each value: <em>minimum inhibitory concentration (MIC)</em> the concentration of antibiotic (in micrograms per milliliter) required to prevent growth in vitro. Lower values means antibiotic is more effective</li>
<li>There are two other columns with the genus of the bacteria and the response to a lab procedure called “gram staining”. We will come back to these later.</li>
<li>Discussion questions: 1) are these data “tidy”? 2) if no, how would you tidy them?</li>
</ul>
<!-- PG to GGG 
* add a reshape command here 
* what year is this dataset come from? who generated it and how was it generated?
-->
<p>Research questions</p>
<ol type="1">
<li>How does effective is neomycin against different types of bacteria?</li>
<li>How does neomycin compare to other antibiotics, such as streptomycin and penicillin?</li>
<li>For which types of bacteria are neomycin and penicillin effective?</li>
</ol>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> altair <span class="im">as</span> alt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>antibiotics <span class="op">=</span> <span class="st">'https://cdn.jsdelivr.net/npm/vega-datasets@1/data/burtin.json'</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>pd.read_json(antibiotics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>antibiotics[[<span class="st">'Bacteria'</span>, <span class="st">'Penicillin'</span>, <span class="st">'Streptomycin'</span>, <span class="st">'Neomycin'</span>]].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Bacteria</th>
      <th>Penicillin</th>
      <th>Streptomycin</th>
      <th>Neomycin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aerobacter aerogenes</td>
      <td>870.000</td>
      <td>1.00</td>
      <td>1.600</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bacillus anthracis</td>
      <td>0.001</td>
      <td>0.01</td>
      <td>0.007</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Brucella abortus</td>
      <td>1.000</td>
      <td>2.00</td>
      <td>0.020</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Diplococcus pneumoniae</td>
      <td>0.005</td>
      <td>11.00</td>
      <td>10.000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Escherichia coli</td>
      <td>100.000</td>
      <td>0.40</td>
      <td>0.100</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="configuring-scales-and-axes" class="level1">
<h1>Configuring Scales and Axes</h1>
<section id="configuring-scales-and-axes-roadmap" class="level2">
<h2 class="anchored" data-anchor-id="configuring-scales-and-axes-roadmap">Configuring Scales and Axes: roadmap</h2>
<ul>
<li>manipulate <code>alt.Scale()</code></li>
<li>clarify the meaning implied by an axis</li>
<li>change the length (<code>domain</code>) of an axis</li>
<li>change grid lines via <code>alt.Axis()</code></li>
</ul>
</section>
<section id="plotting-antibiotic-resistance-adjusting-the-scale-type" class="level2">
<h2 class="anchored" data-anchor-id="plotting-antibiotic-resistance-adjusting-the-scale-type">Plotting Antibiotic Resistance: Adjusting the Scale Type</h2>
<p>Default scale is linear</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>alt.Chart(antibiotics).mark_circle().encode(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    alt.X(<span class="st">'Neomycin:Q'</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">

<style>
  #altair-viz-421477cae5ad4f2588f28c14e922bf38.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-421477cae5ad4f2588f28c14e922bf38.vega-embed details,
  #altair-viz-421477cae5ad4f2588f28c14e922bf38.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-421477cae5ad4f2588f28c14e922bf38"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-421477cae5ad4f2588f28c14e922bf38") {
      outputDiv = document.getElementById("altair-viz-421477cae5ad4f2588f28c14e922bf38");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-9358c74bfa85e269e603e741ba1c4924"}, "mark": {"type": "circle"}, "encoding": {"x": {"field": "Neomycin", "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-9358c74bfa85e269e603e741ba1c4924": [{"Bacteria": "Aerobacter aerogenes", "Penicillin": 870.0, "Streptomycin": 1.0, "Neomycin": 1.6, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Bacillus anthracis", "Penicillin": 0.001, "Streptomycin": 0.01, "Neomycin": 0.007, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Brucella abortus", "Penicillin": 1.0, "Streptomycin": 2.0, "Neomycin": 0.02, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Diplococcus pneumoniae", "Penicillin": 0.005, "Streptomycin": 11.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Escherichia coli", "Penicillin": 100.0, "Streptomycin": 0.4, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Klebsiella pneumoniae", "Penicillin": 850.0, "Streptomycin": 1.2, "Neomycin": 1.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Mycobacterium tuberculosis", "Penicillin": 800.0, "Streptomycin": 5.0, "Neomycin": 2.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Proteus vulgaris", "Penicillin": 3.0, "Streptomycin": 0.1, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Pseudomonas aeruginosa", "Penicillin": 850.0, "Streptomycin": 2.0, "Neomycin": 0.4, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Salmonella (Eberthella) typhosa", "Penicillin": 1.0, "Streptomycin": 0.4, "Neomycin": 0.008, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Salmonella schottmuelleri", "Penicillin": 10.0, "Streptomycin": 0.8, "Neomycin": 0.09, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Staphylococcus albus", "Penicillin": 0.007, "Streptomycin": 0.1, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Staphylococcus aureus", "Penicillin": 0.03, "Streptomycin": 0.03, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Streptococcus fecalis", "Penicillin": 1.0, "Streptomycin": 1.0, "Neomycin": 0.1, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus hemolyticus", "Penicillin": 0.001, "Streptomycin": 14.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus viridans", "Penicillin": 0.005, "Streptomycin": 10.0, "Neomycin": 40.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<p>Why is this plot hard to read?</p>
<div class="notes">
<p><strong>NOTES:</strong> <em>solution: all the points are clustered at the bottom</em></p>
</div>
</section>
<section id="alt-scale-i" class="level2">
<h2 class="anchored" data-anchor-id="alt-scale-i">alt scale I</h2>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>alt.Chart(antibiotics).mark_circle().encode(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    alt.X(<span class="st">'Neomycin:Q'</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'sqrt'</span>))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">

<style>
  #altair-viz-083968d61c224948aacc4941a0cb88e2.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-083968d61c224948aacc4941a0cb88e2.vega-embed details,
  #altair-viz-083968d61c224948aacc4941a0cb88e2.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-083968d61c224948aacc4941a0cb88e2"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-083968d61c224948aacc4941a0cb88e2") {
      outputDiv = document.getElementById("altair-viz-083968d61c224948aacc4941a0cb88e2");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-9358c74bfa85e269e603e741ba1c4924"}, "mark": {"type": "circle"}, "encoding": {"x": {"field": "Neomycin", "scale": {"type": "sqrt"}, "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-9358c74bfa85e269e603e741ba1c4924": [{"Bacteria": "Aerobacter aerogenes", "Penicillin": 870.0, "Streptomycin": 1.0, "Neomycin": 1.6, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Bacillus anthracis", "Penicillin": 0.001, "Streptomycin": 0.01, "Neomycin": 0.007, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Brucella abortus", "Penicillin": 1.0, "Streptomycin": 2.0, "Neomycin": 0.02, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Diplococcus pneumoniae", "Penicillin": 0.005, "Streptomycin": 11.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Escherichia coli", "Penicillin": 100.0, "Streptomycin": 0.4, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Klebsiella pneumoniae", "Penicillin": 850.0, "Streptomycin": 1.2, "Neomycin": 1.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Mycobacterium tuberculosis", "Penicillin": 800.0, "Streptomycin": 5.0, "Neomycin": 2.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Proteus vulgaris", "Penicillin": 3.0, "Streptomycin": 0.1, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Pseudomonas aeruginosa", "Penicillin": 850.0, "Streptomycin": 2.0, "Neomycin": 0.4, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Salmonella (Eberthella) typhosa", "Penicillin": 1.0, "Streptomycin": 0.4, "Neomycin": 0.008, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Salmonella schottmuelleri", "Penicillin": 10.0, "Streptomycin": 0.8, "Neomycin": 0.09, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Staphylococcus albus", "Penicillin": 0.007, "Streptomycin": 0.1, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Staphylococcus aureus", "Penicillin": 0.03, "Streptomycin": 0.03, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Streptococcus fecalis", "Penicillin": 1.0, "Streptomycin": 1.0, "Neomycin": 0.1, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus hemolyticus", "Penicillin": 0.001, "Streptomycin": 14.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus viridans", "Penicillin": 0.005, "Streptomycin": 10.0, "Neomycin": 40.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</section>
<section id="alt-scale-ii" class="level2">
<h2 class="anchored" data-anchor-id="alt-scale-ii">alt scale II</h2>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>alt.Chart(antibiotics).mark_circle().encode(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    alt.X(<span class="st">'Neomycin:Q'</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">

<style>
  #altair-viz-3c9469f2c4c343e7a60a39e27bda5b82.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-3c9469f2c4c343e7a60a39e27bda5b82.vega-embed details,
  #altair-viz-3c9469f2c4c343e7a60a39e27bda5b82.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-3c9469f2c4c343e7a60a39e27bda5b82"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-3c9469f2c4c343e7a60a39e27bda5b82") {
      outputDiv = document.getElementById("altair-viz-3c9469f2c4c343e7a60a39e27bda5b82");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-9358c74bfa85e269e603e741ba1c4924"}, "mark": {"type": "circle"}, "encoding": {"x": {"field": "Neomycin", "scale": {"type": "log"}, "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-9358c74bfa85e269e603e741ba1c4924": [{"Bacteria": "Aerobacter aerogenes", "Penicillin": 870.0, "Streptomycin": 1.0, "Neomycin": 1.6, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Bacillus anthracis", "Penicillin": 0.001, "Streptomycin": 0.01, "Neomycin": 0.007, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Brucella abortus", "Penicillin": 1.0, "Streptomycin": 2.0, "Neomycin": 0.02, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Diplococcus pneumoniae", "Penicillin": 0.005, "Streptomycin": 11.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Escherichia coli", "Penicillin": 100.0, "Streptomycin": 0.4, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Klebsiella pneumoniae", "Penicillin": 850.0, "Streptomycin": 1.2, "Neomycin": 1.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Mycobacterium tuberculosis", "Penicillin": 800.0, "Streptomycin": 5.0, "Neomycin": 2.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Proteus vulgaris", "Penicillin": 3.0, "Streptomycin": 0.1, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Pseudomonas aeruginosa", "Penicillin": 850.0, "Streptomycin": 2.0, "Neomycin": 0.4, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Salmonella (Eberthella) typhosa", "Penicillin": 1.0, "Streptomycin": 0.4, "Neomycin": 0.008, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Salmonella schottmuelleri", "Penicillin": 10.0, "Streptomycin": 0.8, "Neomycin": 0.09, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Staphylococcus albus", "Penicillin": 0.007, "Streptomycin": 0.1, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Staphylococcus aureus", "Penicillin": 0.03, "Streptomycin": 0.03, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Streptococcus fecalis", "Penicillin": 1.0, "Streptomycin": 1.0, "Neomycin": 0.1, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus hemolyticus", "Penicillin": 0.001, "Streptomycin": 14.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus viridans", "Penicillin": 0.005, "Streptomycin": 10.0, "Neomycin": 40.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<p>What does this plot do well? What is confusing about it?</p>
<div class="notes">
<p><strong>NOTES:</strong> *solution: does well: gives a broad sense of scale</p>
<p>does poorly: The hashes between units of base 10 are not equally spaced and therefore pretty hard to read. It seems like they are trying to capture equally divided units (e.g.&nbsp;1, 2, 3, 4, 5…). But even this is not correct! I think there are only 7 dashes between each value, like 1 and 10. So that suggests that there is something more complicated going on. My best guess is that it choose to suppress dashes 8 and 9, but this is pretty confusing for a reader…*</p>
</div>
</section>
<section id="styling-an-axis" class="level2">
<h2 class="anchored" data-anchor-id="styling-an-axis">Styling an Axis</h2>
<ul>
<li>Lower dosages indicate higher effectiveness. However, many readers will expect values that are “better” to be “up and to the right” within a chart.</li>
<li>If we want to cater to this convention set the encoding <code>sort</code> property to <code>'descending'</code>:</li>
</ul>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>alt.Chart(antibiotics).mark_circle().encode(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    alt.X(<span class="st">'Neomycin:Q'</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">

<style>
  #altair-viz-6850afbb50b640bc8e20a31eaf85e1d5.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-6850afbb50b640bc8e20a31eaf85e1d5.vega-embed details,
  #altair-viz-6850afbb50b640bc8e20a31eaf85e1d5.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-6850afbb50b640bc8e20a31eaf85e1d5"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-6850afbb50b640bc8e20a31eaf85e1d5") {
      outputDiv = document.getElementById("altair-viz-6850afbb50b640bc8e20a31eaf85e1d5");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-9358c74bfa85e269e603e741ba1c4924"}, "mark": {"type": "circle"}, "encoding": {"x": {"field": "Neomycin", "scale": {"type": "log"}, "sort": "descending", "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-9358c74bfa85e269e603e741ba1c4924": [{"Bacteria": "Aerobacter aerogenes", "Penicillin": 870.0, "Streptomycin": 1.0, "Neomycin": 1.6, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Bacillus anthracis", "Penicillin": 0.001, "Streptomycin": 0.01, "Neomycin": 0.007, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Brucella abortus", "Penicillin": 1.0, "Streptomycin": 2.0, "Neomycin": 0.02, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Diplococcus pneumoniae", "Penicillin": 0.005, "Streptomycin": 11.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Escherichia coli", "Penicillin": 100.0, "Streptomycin": 0.4, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Klebsiella pneumoniae", "Penicillin": 850.0, "Streptomycin": 1.2, "Neomycin": 1.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Mycobacterium tuberculosis", "Penicillin": 800.0, "Streptomycin": 5.0, "Neomycin": 2.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Proteus vulgaris", "Penicillin": 3.0, "Streptomycin": 0.1, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Pseudomonas aeruginosa", "Penicillin": 850.0, "Streptomycin": 2.0, "Neomycin": 0.4, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Salmonella (Eberthella) typhosa", "Penicillin": 1.0, "Streptomycin": 0.4, "Neomycin": 0.008, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Salmonella schottmuelleri", "Penicillin": 10.0, "Streptomycin": 0.8, "Neomycin": 0.09, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Staphylococcus albus", "Penicillin": 0.007, "Streptomycin": 0.1, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Staphylococcus aureus", "Penicillin": 0.03, "Streptomycin": 0.03, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Streptococcus fecalis", "Penicillin": 1.0, "Streptomycin": 1.0, "Neomycin": 0.1, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus hemolyticus", "Penicillin": 0.001, "Streptomycin": 14.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus viridans", "Penicillin": 0.005, "Streptomycin": 10.0, "Neomycin": 40.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</section>
<section id="add-a-clarifying-title" class="level2">
<h2 class="anchored" data-anchor-id="add-a-clarifying-title">add a clarifying title</h2>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>alt.Chart(antibiotics).mark_circle().encode(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    alt.X(<span class="st">'Neomycin:Q'</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Neomycin MIC (μg/ml) --- more effective →'</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">

<style>
  #altair-viz-f4890df2a1514734b1d43938b4a9ea86.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-f4890df2a1514734b1d43938b4a9ea86.vega-embed details,
  #altair-viz-f4890df2a1514734b1d43938b4a9ea86.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-f4890df2a1514734b1d43938b4a9ea86"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-f4890df2a1514734b1d43938b4a9ea86") {
      outputDiv = document.getElementById("altair-viz-f4890df2a1514734b1d43938b4a9ea86");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-9358c74bfa85e269e603e741ba1c4924"}, "mark": {"type": "circle"}, "encoding": {"x": {"field": "Neomycin", "scale": {"type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Neomycin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-9358c74bfa85e269e603e741ba1c4924": [{"Bacteria": "Aerobacter aerogenes", "Penicillin": 870.0, "Streptomycin": 1.0, "Neomycin": 1.6, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Bacillus anthracis", "Penicillin": 0.001, "Streptomycin": 0.01, "Neomycin": 0.007, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Brucella abortus", "Penicillin": 1.0, "Streptomycin": 2.0, "Neomycin": 0.02, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Diplococcus pneumoniae", "Penicillin": 0.005, "Streptomycin": 11.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Escherichia coli", "Penicillin": 100.0, "Streptomycin": 0.4, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Klebsiella pneumoniae", "Penicillin": 850.0, "Streptomycin": 1.2, "Neomycin": 1.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Mycobacterium tuberculosis", "Penicillin": 800.0, "Streptomycin": 5.0, "Neomycin": 2.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Proteus vulgaris", "Penicillin": 3.0, "Streptomycin": 0.1, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Pseudomonas aeruginosa", "Penicillin": 850.0, "Streptomycin": 2.0, "Neomycin": 0.4, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Salmonella (Eberthella) typhosa", "Penicillin": 1.0, "Streptomycin": 0.4, "Neomycin": 0.008, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Salmonella schottmuelleri", "Penicillin": 10.0, "Streptomycin": 0.8, "Neomycin": 0.09, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Staphylococcus albus", "Penicillin": 0.007, "Streptomycin": 0.1, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Staphylococcus aureus", "Penicillin": 0.03, "Streptomycin": 0.03, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Streptococcus fecalis", "Penicillin": 1.0, "Streptomycin": 1.0, "Neomycin": 0.1, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus hemolyticus", "Penicillin": 0.001, "Streptomycin": 14.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus viridans", "Penicillin": 0.005, "Streptomycin": 10.0, "Neomycin": 40.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<p>Editorial remark: the textbook suggests a title of “Neomycin MIC (μg/ml, reverse log scale)”. This is accurate, but I don’t know it helps the reader that much.</p>
<ol type="1">
<li>The fact that it is a log scale is self-evident. So is the fact that it is reversed.</li>
<li>What the reader really wants to know is which direction is “good”. Just tell them that directly.</li>
</ol>
</section>
<section id="comparing-antibiotics-adjusting-grid-lines-tick-counts-and-sizing" class="level2">
<h2 class="anchored" data-anchor-id="comparing-antibiotics-adjusting-grid-lines-tick-counts-and-sizing">Comparing Antibiotics: Adjusting Grid Lines, Tick Counts, and Sizing</h2>
<p><em>How does neomycin compare to streptomycin?</em></p>
<p>Question for the class: what does each point repesent?</p>
<div class="notes">
<p><strong>NOTES:</strong> <em>solution: Each point is 1 bacteria strain, and we’re plotting two of the bacteria’s properties against each other.</em></p>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>alt.Chart(antibiotics).mark_circle().encode(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    alt.X(<span class="st">'Neomycin:Q'</span>,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Neomycin MIC (μg/ml) --- more effective →'</span>),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    alt.Y(<span class="st">'Streptomycin:Q'</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Streptomycin MIC (μg/ml) --- more effective →'</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">

<style>
  #altair-viz-587e90c268094b799de3217125dff449.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-587e90c268094b799de3217125dff449.vega-embed details,
  #altair-viz-587e90c268094b799de3217125dff449.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-587e90c268094b799de3217125dff449"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-587e90c268094b799de3217125dff449") {
      outputDiv = document.getElementById("altair-viz-587e90c268094b799de3217125dff449");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-9358c74bfa85e269e603e741ba1c4924"}, "mark": {"type": "circle"}, "encoding": {"x": {"field": "Neomycin", "scale": {"type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Neomycin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}, "y": {"field": "Streptomycin", "scale": {"type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Streptomycin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-9358c74bfa85e269e603e741ba1c4924": [{"Bacteria": "Aerobacter aerogenes", "Penicillin": 870.0, "Streptomycin": 1.0, "Neomycin": 1.6, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Bacillus anthracis", "Penicillin": 0.001, "Streptomycin": 0.01, "Neomycin": 0.007, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Brucella abortus", "Penicillin": 1.0, "Streptomycin": 2.0, "Neomycin": 0.02, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Diplococcus pneumoniae", "Penicillin": 0.005, "Streptomycin": 11.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Escherichia coli", "Penicillin": 100.0, "Streptomycin": 0.4, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Klebsiella pneumoniae", "Penicillin": 850.0, "Streptomycin": 1.2, "Neomycin": 1.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Mycobacterium tuberculosis", "Penicillin": 800.0, "Streptomycin": 5.0, "Neomycin": 2.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Proteus vulgaris", "Penicillin": 3.0, "Streptomycin": 0.1, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Pseudomonas aeruginosa", "Penicillin": 850.0, "Streptomycin": 2.0, "Neomycin": 0.4, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Salmonella (Eberthella) typhosa", "Penicillin": 1.0, "Streptomycin": 0.4, "Neomycin": 0.008, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Salmonella schottmuelleri", "Penicillin": 10.0, "Streptomycin": 0.8, "Neomycin": 0.09, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Staphylococcus albus", "Penicillin": 0.007, "Streptomycin": 0.1, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Staphylococcus aureus", "Penicillin": 0.03, "Streptomycin": 0.03, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Streptococcus fecalis", "Penicillin": 1.0, "Streptomycin": 1.0, "Neomycin": 0.1, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus hemolyticus", "Penicillin": 0.001, "Streptomycin": 14.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus viridans", "Penicillin": 0.005, "Streptomycin": 10.0, "Neomycin": 40.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<p>Bacteria responds similarly to these two antibiotics</p>
<p><em>How does neomycin compare to penicillin?</em></p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>alt.Chart(antibiotics).mark_circle().encode(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    alt.X(<span class="st">'Neomycin:Q'</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Neomycin MIC (μg/ml) --- more effective →'</span>),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    alt.Y(<span class="st">'Penicillin:Q'</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Penicillin MIC (μg/ml) --- more effective →'</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">

<style>
  #altair-viz-d7072011ca8e4d56a68bbe21694fdd21.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-d7072011ca8e4d56a68bbe21694fdd21.vega-embed details,
  #altair-viz-d7072011ca8e4d56a68bbe21694fdd21.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-d7072011ca8e4d56a68bbe21694fdd21"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-d7072011ca8e4d56a68bbe21694fdd21") {
      outputDiv = document.getElementById("altair-viz-d7072011ca8e4d56a68bbe21694fdd21");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-9358c74bfa85e269e603e741ba1c4924"}, "mark": {"type": "circle"}, "encoding": {"x": {"field": "Neomycin", "scale": {"type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Neomycin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}, "y": {"field": "Penicillin", "scale": {"type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Penicillin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-9358c74bfa85e269e603e741ba1c4924": [{"Bacteria": "Aerobacter aerogenes", "Penicillin": 870.0, "Streptomycin": 1.0, "Neomycin": 1.6, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Bacillus anthracis", "Penicillin": 0.001, "Streptomycin": 0.01, "Neomycin": 0.007, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Brucella abortus", "Penicillin": 1.0, "Streptomycin": 2.0, "Neomycin": 0.02, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Diplococcus pneumoniae", "Penicillin": 0.005, "Streptomycin": 11.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Escherichia coli", "Penicillin": 100.0, "Streptomycin": 0.4, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Klebsiella pneumoniae", "Penicillin": 850.0, "Streptomycin": 1.2, "Neomycin": 1.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Mycobacterium tuberculosis", "Penicillin": 800.0, "Streptomycin": 5.0, "Neomycin": 2.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Proteus vulgaris", "Penicillin": 3.0, "Streptomycin": 0.1, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Pseudomonas aeruginosa", "Penicillin": 850.0, "Streptomycin": 2.0, "Neomycin": 0.4, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Salmonella (Eberthella) typhosa", "Penicillin": 1.0, "Streptomycin": 0.4, "Neomycin": 0.008, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Salmonella schottmuelleri", "Penicillin": 10.0, "Streptomycin": 0.8, "Neomycin": 0.09, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Staphylococcus albus", "Penicillin": 0.007, "Streptomycin": 0.1, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Staphylococcus aureus", "Penicillin": 0.03, "Streptomycin": 0.03, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Streptococcus fecalis", "Penicillin": 1.0, "Streptomycin": 1.0, "Neomycin": 0.1, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus hemolyticus", "Penicillin": 0.001, "Streptomycin": 14.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus viridans", "Penicillin": 0.005, "Streptomycin": 10.0, "Neomycin": 40.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<p><em>Now we see a more differentiated response: some bacteria respond well to neomycin but not penicillin, and vice versa!</em></p>
</section>
<section id="fix-domain-equalize-aspect-ratio" class="level2">
<h2 class="anchored" data-anchor-id="fix-domain-equalize-aspect-ratio">fix <code>domain</code>, equalize aspect ratio</h2>
<p>While this plot is useful, we can make it better. The x and y axes use the same units, but have different extents (the chart width is larger than the height) and different domains (0.001 to 100 for the x-axis, and 0.001 to 1,000 for the y-axis).</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>alt.Chart(antibiotics).mark_circle().encode(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    alt.X(<span class="st">'Neomycin:Q'</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>, domain<span class="op">=</span>[<span class="fl">0.001</span>, <span class="dv">1000</span>]),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Neomycin MIC (μg/ml) --- more effective →'</span>),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    alt.Y(<span class="st">'Penicillin:Q'</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>, domain<span class="op">=</span>[<span class="fl">0.001</span>, <span class="dv">1000</span>]),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Penicillin MIC (μg/ml) --- more effective →'</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>).properties(width<span class="op">=</span><span class="dv">250</span>, height<span class="op">=</span><span class="dv">250</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">

<style>
  #altair-viz-3f33c9dd6ccf4fa29795c5773140f74b.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-3f33c9dd6ccf4fa29795c5773140f74b.vega-embed details,
  #altair-viz-3f33c9dd6ccf4fa29795c5773140f74b.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-3f33c9dd6ccf4fa29795c5773140f74b"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-3f33c9dd6ccf4fa29795c5773140f74b") {
      outputDiv = document.getElementById("altair-viz-3f33c9dd6ccf4fa29795c5773140f74b");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-9358c74bfa85e269e603e741ba1c4924"}, "mark": {"type": "circle"}, "encoding": {"x": {"field": "Neomycin", "scale": {"domain": [0.001, 1000], "type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Neomycin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}, "y": {"field": "Penicillin", "scale": {"domain": [0.001, 1000], "type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Penicillin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}}, "height": 250, "width": 250, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-9358c74bfa85e269e603e741ba1c4924": [{"Bacteria": "Aerobacter aerogenes", "Penicillin": 870.0, "Streptomycin": 1.0, "Neomycin": 1.6, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Bacillus anthracis", "Penicillin": 0.001, "Streptomycin": 0.01, "Neomycin": 0.007, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Brucella abortus", "Penicillin": 1.0, "Streptomycin": 2.0, "Neomycin": 0.02, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Diplococcus pneumoniae", "Penicillin": 0.005, "Streptomycin": 11.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Escherichia coli", "Penicillin": 100.0, "Streptomycin": 0.4, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Klebsiella pneumoniae", "Penicillin": 850.0, "Streptomycin": 1.2, "Neomycin": 1.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Mycobacterium tuberculosis", "Penicillin": 800.0, "Streptomycin": 5.0, "Neomycin": 2.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Proteus vulgaris", "Penicillin": 3.0, "Streptomycin": 0.1, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Pseudomonas aeruginosa", "Penicillin": 850.0, "Streptomycin": 2.0, "Neomycin": 0.4, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Salmonella (Eberthella) typhosa", "Penicillin": 1.0, "Streptomycin": 0.4, "Neomycin": 0.008, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Salmonella schottmuelleri", "Penicillin": 10.0, "Streptomycin": 0.8, "Neomycin": 0.09, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Staphylococcus albus", "Penicillin": 0.007, "Streptomycin": 0.1, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Staphylococcus aureus", "Penicillin": 0.03, "Streptomycin": 0.03, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Streptococcus fecalis", "Penicillin": 1.0, "Streptomycin": 1.0, "Neomycin": 0.1, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus hemolyticus", "Penicillin": 0.001, "Streptomycin": 14.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus viridans", "Penicillin": 0.005, "Streptomycin": 10.0, "Neomycin": 40.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</section>
<section id="reduce-grid-clutter-with-alt.axistickcount5" class="level2">
<h2 class="anchored" data-anchor-id="reduce-grid-clutter-with-alt.axistickcount5">reduce grid clutter with <code>alt.Axis(tickCount=5)</code></h2>
<p>Also set <code>mark_circle(size=80)</code></p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>alt.Chart(antibiotics).mark_circle(size<span class="op">=</span><span class="dv">80</span>).encode(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    alt.X(<span class="st">'Neomycin:Q'</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>, domain<span class="op">=</span>[<span class="fl">0.001</span>, <span class="dv">1000</span>]),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>          axis<span class="op">=</span>alt.Axis(tickCount<span class="op">=</span><span class="dv">5</span>),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Neomycin MIC (μg/ml) --- more effective →'</span>),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    alt.Y(<span class="st">'Penicillin:Q'</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>, domain<span class="op">=</span>[<span class="fl">0.001</span>, <span class="dv">1000</span>]),</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>          axis<span class="op">=</span>alt.Axis(tickCount<span class="op">=</span><span class="dv">5</span>),</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Penicillin MIC (μg/ml) --- more effective →'</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>).properties(width<span class="op">=</span><span class="dv">250</span>, height<span class="op">=</span><span class="dv">250</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">

<style>
  #altair-viz-ebe96a4fb9cd46399d89d06cd0b17212.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-ebe96a4fb9cd46399d89d06cd0b17212.vega-embed details,
  #altair-viz-ebe96a4fb9cd46399d89d06cd0b17212.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-ebe96a4fb9cd46399d89d06cd0b17212"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-ebe96a4fb9cd46399d89d06cd0b17212") {
      outputDiv = document.getElementById("altair-viz-ebe96a4fb9cd46399d89d06cd0b17212");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-9358c74bfa85e269e603e741ba1c4924"}, "mark": {"type": "circle", "size": 80}, "encoding": {"x": {"axis": {"tickCount": 5}, "field": "Neomycin", "scale": {"domain": [0.001, 1000], "type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Neomycin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}, "y": {"axis": {"tickCount": 5}, "field": "Penicillin", "scale": {"domain": [0.001, 1000], "type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Penicillin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}}, "height": 250, "width": 250, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-9358c74bfa85e269e603e741ba1c4924": [{"Bacteria": "Aerobacter aerogenes", "Penicillin": 870.0, "Streptomycin": 1.0, "Neomycin": 1.6, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Bacillus anthracis", "Penicillin": 0.001, "Streptomycin": 0.01, "Neomycin": 0.007, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Brucella abortus", "Penicillin": 1.0, "Streptomycin": 2.0, "Neomycin": 0.02, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Diplococcus pneumoniae", "Penicillin": 0.005, "Streptomycin": 11.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Escherichia coli", "Penicillin": 100.0, "Streptomycin": 0.4, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Klebsiella pneumoniae", "Penicillin": 850.0, "Streptomycin": 1.2, "Neomycin": 1.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Mycobacterium tuberculosis", "Penicillin": 800.0, "Streptomycin": 5.0, "Neomycin": 2.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Proteus vulgaris", "Penicillin": 3.0, "Streptomycin": 0.1, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Pseudomonas aeruginosa", "Penicillin": 850.0, "Streptomycin": 2.0, "Neomycin": 0.4, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Salmonella (Eberthella) typhosa", "Penicillin": 1.0, "Streptomycin": 0.4, "Neomycin": 0.008, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Salmonella schottmuelleri", "Penicillin": 10.0, "Streptomycin": 0.8, "Neomycin": 0.09, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Staphylococcus albus", "Penicillin": 0.007, "Streptomycin": 0.1, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Staphylococcus aureus", "Penicillin": 0.03, "Streptomycin": 0.03, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Streptococcus fecalis", "Penicillin": 1.0, "Streptomycin": 1.0, "Neomycin": 0.1, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus hemolyticus", "Penicillin": 0.001, "Streptomycin": 14.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus viridans", "Penicillin": 0.005, "Streptomycin": 10.0, "Neomycin": 40.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<p>Discussion questions: 1) What questions does this plot answer? 2) What further questions does this plot raise?</p>
<div class="notes">
<p><strong>NOTES:</strong> <em>solution Answers: 1) some bacteria respond well to neomycin but not penicillin, and vice versa! 2) for what types of bacteria is N effective or P effective? Need some way to dig deeper. This is what we will do in the remainder of the lecture</em></p>
</div>
</section>
<section id="configuring-scales-and-axes-summary" class="level2">
<h2 class="anchored" data-anchor-id="configuring-scales-and-axes-summary">Configuring Scales and Axes: summary</h2>
<p>How to make your axes and grids as informative as possible</p>
<ul>
<li>Choose an <code>alt.Scale()</code> that reveals differences between the data (in most cases…)</li>
<li>Axis titles should clarify meaning</li>
<li>Deliberately choose axis length via <code>domain</code> argument</li>
<li>Reduce grid clutter via <code>alt.Axis()</code></li>
</ul>
</section>
</section>
<section id="configuring-color-legends" class="level1">
<h1>Configuring Color Legends</h1>
<section id="configuring-color-legends-roadmap-and-warning" class="level2">
<h2 class="anchored" data-anchor-id="configuring-color-legends-roadmap-and-warning">Configuring Color Legends: roadmap and warning</h2>
<ul>
<li>Visualization as a tool for discovery</li>
<li><code>alt.Color()</code> in legends
<ul>
<li>binary variable</li>
<li>text data (every dot is different)</li>
<li>groups</li>
</ul></li>
<li>use color to encode quantitative values</li>
</ul>
<p>Remarks:</p>
<ul>
<li>This section of the textbook asks you to practice your “skepticism” muscle. What we mean by that is that it is mostly about showing what does <em>not</em> work. we will follow the textbook, but for many of the plots, your first question should not be “where would I want to use this tool?” but rather “why is this not a good idea?”</li>
<li>The official title of this section of lecture is about color legends, but the deeper lessons are about how to clean data to uncover and communciate structure</li>
</ul>
</section>
<section id="visualization-as-a-tool-for-discovery" class="level2">
<h2 class="anchored" data-anchor-id="visualization-as-a-tool-for-discovery">Visualization as a tool for discovery</h2>
<ul>
<li>Above we saw that neomycin is more effective for some bacteria, while penicillin is more effective for others.</li>
<li>Is there any systematic answer to what types of bacteria each drug is more effective for? This is the kind of question for which data visualization shines.</li>
<li>If we just stared at a table in Excel or Pandas, it might be hard to see patterns (and at the very least it would take awhile). Until now, almost everything we have seen for data visualization has been about <strong>communication</strong>. Now, we are going to see how data visualization can be a tool for <strong>discovery</strong>.</li>
</ul>
</section>
<section id="gram-staining" class="level2">
<h2 class="anchored" data-anchor-id="gram-staining">Gram staining</h2>
<p>Let’s start by looking at one of the other columns in the data frame (which we have ignored until now).</p>
<p>A tiny bit of science: the reaction of the bacteria to a procedure called <a href="https://en.wikipedia.org/wiki/Gram_stain">Gram staining</a> is described by the nominal field <code>Gram_Staining</code>. Bacteria that turn dark blue or violet are Gram-positive. Otherwise, they are Gram-negative.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pictures/Gram_stain_01.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Gram staining example</figcaption><p></p>
</figure>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>antibiotics[[<span class="st">'Gram_Staining'</span>]].tail()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Gram_Staining</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11</th>
      <td>positive</td>
    </tr>
    <tr>
      <th>12</th>
      <td>positive</td>
    </tr>
    <tr>
      <th>13</th>
      <td>positive</td>
    </tr>
    <tr>
      <th>14</th>
      <td>positive</td>
    </tr>
    <tr>
      <th>15</th>
      <td>positive</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="alt.colorgram_stainingn" class="level2">
<h2 class="anchored" data-anchor-id="alt.colorgram_stainingn">alt.Color(‘Gram_Staining:N’)</h2>
<p>Let’s encode <code>Gram_Staining</code> on the <code>color</code> channel as a nominal data type:</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>alt.Chart(antibiotics).mark_circle(size<span class="op">=</span><span class="dv">80</span>).encode(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    alt.X(<span class="st">'Neomycin:Q'</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>, domain<span class="op">=</span>[<span class="fl">0.001</span>, <span class="dv">1000</span>]),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>          axis<span class="op">=</span>alt.Axis(tickCount<span class="op">=</span><span class="dv">5</span>),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Neomycin MIC (μg/ml) --- more effective →'</span>),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    alt.Y(<span class="st">'Penicillin:Q'</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>, domain<span class="op">=</span>[<span class="fl">0.001</span>, <span class="dv">1000</span>]),</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>          axis<span class="op">=</span>alt.Axis(tickCount<span class="op">=</span><span class="dv">5</span>),</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Penicillin MIC (μg/ml) --- more effective →'</span>),</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    alt.Color(<span class="st">'Gram_Staining:N'</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>).properties(width<span class="op">=</span><span class="dv">250</span>, height<span class="op">=</span><span class="dv">250</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">

<style>
  #altair-viz-67833f640b894c0f808181d265a64c25.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-67833f640b894c0f808181d265a64c25.vega-embed details,
  #altair-viz-67833f640b894c0f808181d265a64c25.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-67833f640b894c0f808181d265a64c25"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-67833f640b894c0f808181d265a64c25") {
      outputDiv = document.getElementById("altair-viz-67833f640b894c0f808181d265a64c25");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-9358c74bfa85e269e603e741ba1c4924"}, "mark": {"type": "circle", "size": 80}, "encoding": {"color": {"field": "Gram_Staining", "type": "nominal"}, "x": {"axis": {"tickCount": 5}, "field": "Neomycin", "scale": {"domain": [0.001, 1000], "type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Neomycin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}, "y": {"axis": {"tickCount": 5}, "field": "Penicillin", "scale": {"domain": [0.001, 1000], "type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Penicillin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}}, "height": 250, "width": 250, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-9358c74bfa85e269e603e741ba1c4924": [{"Bacteria": "Aerobacter aerogenes", "Penicillin": 870.0, "Streptomycin": 1.0, "Neomycin": 1.6, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Bacillus anthracis", "Penicillin": 0.001, "Streptomycin": 0.01, "Neomycin": 0.007, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Brucella abortus", "Penicillin": 1.0, "Streptomycin": 2.0, "Neomycin": 0.02, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Diplococcus pneumoniae", "Penicillin": 0.005, "Streptomycin": 11.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Escherichia coli", "Penicillin": 100.0, "Streptomycin": 0.4, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Klebsiella pneumoniae", "Penicillin": 850.0, "Streptomycin": 1.2, "Neomycin": 1.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Mycobacterium tuberculosis", "Penicillin": 800.0, "Streptomycin": 5.0, "Neomycin": 2.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Proteus vulgaris", "Penicillin": 3.0, "Streptomycin": 0.1, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Pseudomonas aeruginosa", "Penicillin": 850.0, "Streptomycin": 2.0, "Neomycin": 0.4, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Salmonella (Eberthella) typhosa", "Penicillin": 1.0, "Streptomycin": 0.4, "Neomycin": 0.008, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Salmonella schottmuelleri", "Penicillin": 10.0, "Streptomycin": 0.8, "Neomycin": 0.09, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Staphylococcus albus", "Penicillin": 0.007, "Streptomycin": 0.1, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Staphylococcus aureus", "Penicillin": 0.03, "Streptomycin": 0.03, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Streptococcus fecalis", "Penicillin": 1.0, "Streptomycin": 1.0, "Neomycin": 0.1, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus hemolyticus", "Penicillin": 0.001, "Streptomycin": 14.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus viridans", "Penicillin": 0.005, "Streptomycin": 10.0, "Neomycin": 40.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<p>We can see that Gram-positive bacteria seem most susceptible to penicillin, whereas neomycin is more effective for Gram-negative bacteria!</p>
</section>
<section id="sometimes-helpful-trick-choose-colors-with-external-meaning" class="level2">
<h2 class="anchored" data-anchor-id="sometimes-helpful-trick-choose-colors-with-external-meaning">Sometimes helpful trick: choose colors with external meaning</h2>
<p>However, we might wish to customize the colors used. In this case, we might want to use the colors that come out in lab when you do gram staining. Let’s use those colors by specifying an explicit scale mapping from the data <code>domain</code> to the color <code>range</code>:</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>alt.Chart(antibiotics).mark_circle(size<span class="op">=</span><span class="dv">80</span>).encode(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    alt.X(<span class="st">'Neomycin:Q'</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>, domain<span class="op">=</span>[<span class="fl">0.001</span>, <span class="dv">1000</span>]),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>          axis<span class="op">=</span>alt.Axis(tickCount<span class="op">=</span><span class="dv">5</span>),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Neomycin MIC (μg/ml) --- more effective →'</span>),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    alt.Y(<span class="st">'Penicillin:Q'</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>, domain<span class="op">=</span>[<span class="fl">0.001</span>, <span class="dv">1000</span>]),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>          axis<span class="op">=</span>alt.Axis(tickCount<span class="op">=</span><span class="dv">5</span>),</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Penicillin MIC (μg/ml) --- more effective →'</span>),</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    alt.Color(<span class="st">'Gram_Staining:N'</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(domain<span class="op">=</span>[<span class="st">'negative'</span>, <span class="st">'positive'</span>], <span class="bu">range</span><span class="op">=</span>[<span class="st">'hotpink'</span>, <span class="st">'purple'</span>])</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>).properties(width<span class="op">=</span><span class="dv">250</span>, height<span class="op">=</span><span class="dv">250</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">

<style>
  #altair-viz-354fab7b239646e2926a43ad234c3c8f.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-354fab7b239646e2926a43ad234c3c8f.vega-embed details,
  #altair-viz-354fab7b239646e2926a43ad234c3c8f.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-354fab7b239646e2926a43ad234c3c8f"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-354fab7b239646e2926a43ad234c3c8f") {
      outputDiv = document.getElementById("altair-viz-354fab7b239646e2926a43ad234c3c8f");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-9358c74bfa85e269e603e741ba1c4924"}, "mark": {"type": "circle", "size": 80}, "encoding": {"color": {"field": "Gram_Staining", "scale": {"domain": ["negative", "positive"], "range": ["hotpink", "purple"]}, "type": "nominal"}, "x": {"axis": {"tickCount": 5}, "field": "Neomycin", "scale": {"domain": [0.001, 1000], "type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Neomycin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}, "y": {"axis": {"tickCount": 5}, "field": "Penicillin", "scale": {"domain": [0.001, 1000], "type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Penicillin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}}, "height": 250, "width": 250, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-9358c74bfa85e269e603e741ba1c4924": [{"Bacteria": "Aerobacter aerogenes", "Penicillin": 870.0, "Streptomycin": 1.0, "Neomycin": 1.6, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Bacillus anthracis", "Penicillin": 0.001, "Streptomycin": 0.01, "Neomycin": 0.007, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Brucella abortus", "Penicillin": 1.0, "Streptomycin": 2.0, "Neomycin": 0.02, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Diplococcus pneumoniae", "Penicillin": 0.005, "Streptomycin": 11.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Escherichia coli", "Penicillin": 100.0, "Streptomycin": 0.4, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Klebsiella pneumoniae", "Penicillin": 850.0, "Streptomycin": 1.2, "Neomycin": 1.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Mycobacterium tuberculosis", "Penicillin": 800.0, "Streptomycin": 5.0, "Neomycin": 2.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Proteus vulgaris", "Penicillin": 3.0, "Streptomycin": 0.1, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Pseudomonas aeruginosa", "Penicillin": 850.0, "Streptomycin": 2.0, "Neomycin": 0.4, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Salmonella (Eberthella) typhosa", "Penicillin": 1.0, "Streptomycin": 0.4, "Neomycin": 0.008, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Salmonella schottmuelleri", "Penicillin": 10.0, "Streptomycin": 0.8, "Neomycin": 0.09, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Staphylococcus albus", "Penicillin": 0.007, "Streptomycin": 0.1, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Staphylococcus aureus", "Penicillin": 0.03, "Streptomycin": 0.03, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Streptococcus fecalis", "Penicillin": 1.0, "Streptomycin": 1.0, "Neomycin": 0.1, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus hemolyticus", "Penicillin": 0.001, "Streptomycin": 14.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus viridans", "Penicillin": 0.005, "Streptomycin": 10.0, "Neomycin": 40.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</section>
<section id="color-by-species-i" class="level2">
<h2 class="anchored" data-anchor-id="color-by-species-i">Color by Species I</h2>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>alt.Chart(antibiotics).mark_circle(size<span class="op">=</span><span class="dv">80</span>).encode(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    alt.X(<span class="st">'Neomycin:Q'</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>, domain<span class="op">=</span>[<span class="fl">0.001</span>, <span class="dv">1000</span>]),</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>          axis<span class="op">=</span>alt.Axis(tickCount<span class="op">=</span><span class="dv">5</span>),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Neomycin MIC (μg/ml) --- more effective →'</span>),</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    alt.Y(<span class="st">'Penicillin:Q'</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>, domain<span class="op">=</span>[<span class="fl">0.001</span>, <span class="dv">1000</span>]),</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>          axis<span class="op">=</span>alt.Axis(tickCount<span class="op">=</span><span class="dv">5</span>),</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Penicillin MIC (μg/ml) --- more effective →'</span>),</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    alt.Color(<span class="st">'Bacteria:N'</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>).properties(width<span class="op">=</span><span class="dv">250</span>, height<span class="op">=</span><span class="dv">250</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">

<style>
  #altair-viz-6250bfb821864d9bae2e1bcd92c2cf5d.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-6250bfb821864d9bae2e1bcd92c2cf5d.vega-embed details,
  #altair-viz-6250bfb821864d9bae2e1bcd92c2cf5d.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-6250bfb821864d9bae2e1bcd92c2cf5d"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-6250bfb821864d9bae2e1bcd92c2cf5d") {
      outputDiv = document.getElementById("altair-viz-6250bfb821864d9bae2e1bcd92c2cf5d");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-9358c74bfa85e269e603e741ba1c4924"}, "mark": {"type": "circle", "size": 80}, "encoding": {"color": {"field": "Bacteria", "type": "nominal"}, "x": {"axis": {"tickCount": 5}, "field": "Neomycin", "scale": {"domain": [0.001, 1000], "type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Neomycin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}, "y": {"axis": {"tickCount": 5}, "field": "Penicillin", "scale": {"domain": [0.001, 1000], "type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Penicillin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}}, "height": 250, "width": 250, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-9358c74bfa85e269e603e741ba1c4924": [{"Bacteria": "Aerobacter aerogenes", "Penicillin": 870.0, "Streptomycin": 1.0, "Neomycin": 1.6, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Bacillus anthracis", "Penicillin": 0.001, "Streptomycin": 0.01, "Neomycin": 0.007, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Brucella abortus", "Penicillin": 1.0, "Streptomycin": 2.0, "Neomycin": 0.02, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Diplococcus pneumoniae", "Penicillin": 0.005, "Streptomycin": 11.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Escherichia coli", "Penicillin": 100.0, "Streptomycin": 0.4, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Klebsiella pneumoniae", "Penicillin": 850.0, "Streptomycin": 1.2, "Neomycin": 1.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Mycobacterium tuberculosis", "Penicillin": 800.0, "Streptomycin": 5.0, "Neomycin": 2.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Proteus vulgaris", "Penicillin": 3.0, "Streptomycin": 0.1, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Pseudomonas aeruginosa", "Penicillin": 850.0, "Streptomycin": 2.0, "Neomycin": 0.4, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Salmonella (Eberthella) typhosa", "Penicillin": 1.0, "Streptomycin": 0.4, "Neomycin": 0.008, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Salmonella schottmuelleri", "Penicillin": 10.0, "Streptomycin": 0.8, "Neomycin": 0.09, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Staphylococcus albus", "Penicillin": 0.007, "Streptomycin": 0.1, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Staphylococcus aureus", "Penicillin": 0.03, "Streptomycin": 0.03, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Streptococcus fecalis", "Penicillin": 1.0, "Streptomycin": 1.0, "Neomycin": 0.1, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus hemolyticus", "Penicillin": 0.001, "Streptomycin": 14.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus viridans", "Penicillin": 0.005, "Streptomycin": 10.0, "Neomycin": 40.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<p>Discussion question: what’s wrong with this plot? ::: {.notes .content-visible when-profile=“speaker”} <strong>NOTES:</strong> <em>solution colors get reused because there are more than 10 legend items</em> :::</p>
</section>
<section id="color-by-species-ii" class="level2">
<h2 class="anchored" data-anchor-id="color-by-species-ii">Color by Species II</h2>
<p>Use <code>tableau20</code> so we have 20 colors instead of 10</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>alt.Chart(antibiotics).mark_circle(size<span class="op">=</span><span class="dv">80</span>).encode(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    alt.X(<span class="st">'Neomycin:Q'</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>, domain<span class="op">=</span>[<span class="fl">0.001</span>, <span class="dv">1000</span>]),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>          axis<span class="op">=</span>alt.Axis(tickCount<span class="op">=</span><span class="dv">5</span>),</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Neomycin MIC (μg/ml) --- more effective →'</span>),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    alt.Y(<span class="st">'Penicillin:Q'</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>, domain<span class="op">=</span>[<span class="fl">0.001</span>, <span class="dv">1000</span>]),</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>          axis<span class="op">=</span>alt.Axis(tickCount<span class="op">=</span><span class="dv">5</span>),</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Penicillin MIC (μg/ml) --- more effective →'</span>),</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    alt.Color(<span class="st">'Bacteria:N'</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(scheme<span class="op">=</span><span class="st">'tableau20'</span>))</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>).properties(width<span class="op">=</span><span class="dv">250</span>, height<span class="op">=</span><span class="dv">250</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">


<style>
  #altair-viz-506c0f7f7ef14c9b8bcc8f1a54023399.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-506c0f7f7ef14c9b8bcc8f1a54023399.vega-embed details,
  #altair-viz-506c0f7f7ef14c9b8bcc8f1a54023399.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-506c0f7f7ef14c9b8bcc8f1a54023399"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-506c0f7f7ef14c9b8bcc8f1a54023399") {
      outputDiv = document.getElementById("altair-viz-506c0f7f7ef14c9b8bcc8f1a54023399");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-9358c74bfa85e269e603e741ba1c4924"}, "mark": {"type": "circle", "size": 80}, "encoding": {"color": {"field": "Bacteria", "scale": {"scheme": "tableau20"}, "type": "nominal"}, "x": {"axis": {"tickCount": 5}, "field": "Neomycin", "scale": {"domain": [0.001, 1000], "type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Neomycin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}, "y": {"axis": {"tickCount": 5}, "field": "Penicillin", "scale": {"domain": [0.001, 1000], "type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Penicillin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}}, "height": 250, "width": 250, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-9358c74bfa85e269e603e741ba1c4924": [{"Bacteria": "Aerobacter aerogenes", "Penicillin": 870.0, "Streptomycin": 1.0, "Neomycin": 1.6, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Bacillus anthracis", "Penicillin": 0.001, "Streptomycin": 0.01, "Neomycin": 0.007, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Brucella abortus", "Penicillin": 1.0, "Streptomycin": 2.0, "Neomycin": 0.02, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Diplococcus pneumoniae", "Penicillin": 0.005, "Streptomycin": 11.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Escherichia coli", "Penicillin": 100.0, "Streptomycin": 0.4, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Klebsiella pneumoniae", "Penicillin": 850.0, "Streptomycin": 1.2, "Neomycin": 1.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Mycobacterium tuberculosis", "Penicillin": 800.0, "Streptomycin": 5.0, "Neomycin": 2.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Proteus vulgaris", "Penicillin": 3.0, "Streptomycin": 0.1, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Pseudomonas aeruginosa", "Penicillin": 850.0, "Streptomycin": 2.0, "Neomycin": 0.4, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Salmonella (Eberthella) typhosa", "Penicillin": 1.0, "Streptomycin": 0.4, "Neomycin": 0.008, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Salmonella schottmuelleri", "Penicillin": 10.0, "Streptomycin": 0.8, "Neomycin": 0.09, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Staphylococcus albus", "Penicillin": 0.007, "Streptomycin": 0.1, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Staphylococcus aureus", "Penicillin": 0.03, "Streptomycin": 0.03, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Streptococcus fecalis", "Penicillin": 1.0, "Streptomycin": 1.0, "Neomycin": 0.1, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus hemolyticus", "Penicillin": 0.001, "Streptomycin": 14.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus viridans", "Penicillin": 0.005, "Streptomycin": 10.0, "Neomycin": 40.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<p>Problem with this plot: bacteria that are similar (all in the “staph” family) have very different colors</p>
</section>
<section id="color-by-species-iii-color-as-o" class="level2">
<h2 class="anchored" data-anchor-id="color-by-species-iii-color-as-o">Color by Species III – color as <code>O</code></h2>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>alt.Chart(antibiotics).mark_circle(size<span class="op">=</span><span class="dv">80</span>).encode(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    alt.X(<span class="st">'Neomycin:Q'</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>, domain<span class="op">=</span>[<span class="fl">0.001</span>, <span class="dv">1000</span>]),</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>          axis<span class="op">=</span>alt.Axis(tickCount<span class="op">=</span><span class="dv">5</span>),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Neomycin MIC (μg/ml) --- more effective →'</span>),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    alt.Y(<span class="st">'Penicillin:Q'</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>, domain<span class="op">=</span>[<span class="fl">0.001</span>, <span class="dv">1000</span>]),</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>          axis<span class="op">=</span>alt.Axis(tickCount<span class="op">=</span><span class="dv">5</span>),</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Penicillin MIC (μg/ml) --- more effective →'</span>),</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    alt.Color(<span class="st">'Bacteria:O'</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>).properties(width<span class="op">=</span><span class="dv">250</span>, height<span class="op">=</span><span class="dv">250</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">

<style>
  #altair-viz-8ce7746bbbdf4b82a1122c91d80d13a2.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-8ce7746bbbdf4b82a1122c91d80d13a2.vega-embed details,
  #altair-viz-8ce7746bbbdf4b82a1122c91d80d13a2.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-8ce7746bbbdf4b82a1122c91d80d13a2"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-8ce7746bbbdf4b82a1122c91d80d13a2") {
      outputDiv = document.getElementById("altair-viz-8ce7746bbbdf4b82a1122c91d80d13a2");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-9358c74bfa85e269e603e741ba1c4924"}, "mark": {"type": "circle", "size": 80}, "encoding": {"color": {"field": "Bacteria", "type": "ordinal"}, "x": {"axis": {"tickCount": 5}, "field": "Neomycin", "scale": {"domain": [0.001, 1000], "type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Neomycin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}, "y": {"axis": {"tickCount": 5}, "field": "Penicillin", "scale": {"domain": [0.001, 1000], "type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Penicillin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}}, "height": 250, "width": 250, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-9358c74bfa85e269e603e741ba1c4924": [{"Bacteria": "Aerobacter aerogenes", "Penicillin": 870.0, "Streptomycin": 1.0, "Neomycin": 1.6, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Bacillus anthracis", "Penicillin": 0.001, "Streptomycin": 0.01, "Neomycin": 0.007, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Brucella abortus", "Penicillin": 1.0, "Streptomycin": 2.0, "Neomycin": 0.02, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Diplococcus pneumoniae", "Penicillin": 0.005, "Streptomycin": 11.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Escherichia coli", "Penicillin": 100.0, "Streptomycin": 0.4, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Klebsiella pneumoniae", "Penicillin": 850.0, "Streptomycin": 1.2, "Neomycin": 1.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Mycobacterium tuberculosis", "Penicillin": 800.0, "Streptomycin": 5.0, "Neomycin": 2.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Proteus vulgaris", "Penicillin": 3.0, "Streptomycin": 0.1, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Pseudomonas aeruginosa", "Penicillin": 850.0, "Streptomycin": 2.0, "Neomycin": 0.4, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Salmonella (Eberthella) typhosa", "Penicillin": 1.0, "Streptomycin": 0.4, "Neomycin": 0.008, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Salmonella schottmuelleri", "Penicillin": 10.0, "Streptomycin": 0.8, "Neomycin": 0.09, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Staphylococcus albus", "Penicillin": 0.007, "Streptomycin": 0.1, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Staphylococcus aureus", "Penicillin": 0.03, "Streptomycin": 0.03, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Streptococcus fecalis", "Penicillin": 1.0, "Streptomycin": 1.0, "Neomycin": 0.1, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus hemolyticus", "Penicillin": 0.001, "Streptomycin": 14.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus viridans", "Penicillin": 0.005, "Streptomycin": 10.0, "Neomycin": 40.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<p>Problems with this plot:</p>
<ol type="1">
<li>the blue shades are hard to distinguish from one another.</li>
<li>although it is nice to assign similar colors to bacteria in the same family, this legend also assigns similar colors to bacteria that are not in the same family</li>
</ol>
<p>A partial solution to (1) is to use a different color scheme</p>
</section>
<section id="color-by-species-iv-use-viridis" class="level2">
<h2 class="anchored" data-anchor-id="color-by-species-iv-use-viridis">Color by Species IV – use <code>viridis</code></h2>
<p>This scheme increases both hue and luminance</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>alt.Chart(antibiotics).mark_circle(size<span class="op">=</span><span class="dv">80</span>).encode(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    alt.X(<span class="st">'Neomycin:Q'</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>, domain<span class="op">=</span>[<span class="fl">0.001</span>, <span class="dv">1000</span>]),</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>          axis<span class="op">=</span>alt.Axis(tickCount<span class="op">=</span><span class="dv">5</span>),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Neomycin MIC (μg/ml) --- more effective →'</span>),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    alt.Y(<span class="st">'Penicillin:Q'</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>, domain<span class="op">=</span>[<span class="fl">0.001</span>, <span class="dv">1000</span>]),</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>          axis<span class="op">=</span>alt.Axis(tickCount<span class="op">=</span><span class="dv">5</span>),</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Penicillin MIC (μg/ml) --- more effective →'</span>),</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    alt.Color(<span class="st">'Bacteria:O'</span>,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(scheme<span class="op">=</span><span class="st">'viridis'</span>))</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>).properties(width<span class="op">=</span><span class="dv">250</span>, height<span class="op">=</span><span class="dv">250</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">

<style>
  #altair-viz-809e68680cc2438dba7e829172dbabbb.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-809e68680cc2438dba7e829172dbabbb.vega-embed details,
  #altair-viz-809e68680cc2438dba7e829172dbabbb.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-809e68680cc2438dba7e829172dbabbb"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-809e68680cc2438dba7e829172dbabbb") {
      outputDiv = document.getElementById("altair-viz-809e68680cc2438dba7e829172dbabbb");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-9358c74bfa85e269e603e741ba1c4924"}, "mark": {"type": "circle", "size": 80}, "encoding": {"color": {"field": "Bacteria", "scale": {"scheme": "viridis"}, "type": "ordinal"}, "x": {"axis": {"tickCount": 5}, "field": "Neomycin", "scale": {"domain": [0.001, 1000], "type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Neomycin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}, "y": {"axis": {"tickCount": 5}, "field": "Penicillin", "scale": {"domain": [0.001, 1000], "type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Penicillin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}}, "height": 250, "width": 250, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-9358c74bfa85e269e603e741ba1c4924": [{"Bacteria": "Aerobacter aerogenes", "Penicillin": 870.0, "Streptomycin": 1.0, "Neomycin": 1.6, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Bacillus anthracis", "Penicillin": 0.001, "Streptomycin": 0.01, "Neomycin": 0.007, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Brucella abortus", "Penicillin": 1.0, "Streptomycin": 2.0, "Neomycin": 0.02, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Diplococcus pneumoniae", "Penicillin": 0.005, "Streptomycin": 11.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Escherichia coli", "Penicillin": 100.0, "Streptomycin": 0.4, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Klebsiella pneumoniae", "Penicillin": 850.0, "Streptomycin": 1.2, "Neomycin": 1.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Mycobacterium tuberculosis", "Penicillin": 800.0, "Streptomycin": 5.0, "Neomycin": 2.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Proteus vulgaris", "Penicillin": 3.0, "Streptomycin": 0.1, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Pseudomonas aeruginosa", "Penicillin": 850.0, "Streptomycin": 2.0, "Neomycin": 0.4, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Salmonella (Eberthella) typhosa", "Penicillin": 1.0, "Streptomycin": 0.4, "Neomycin": 0.008, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Salmonella schottmuelleri", "Penicillin": 10.0, "Streptomycin": 0.8, "Neomycin": 0.09, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Staphylococcus albus", "Penicillin": 0.007, "Streptomycin": 0.1, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Staphylococcus aureus", "Penicillin": 0.03, "Streptomycin": 0.03, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Streptococcus fecalis", "Penicillin": 1.0, "Streptomycin": 1.0, "Neomycin": 0.1, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus hemolyticus", "Penicillin": 0.001, "Streptomycin": 14.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus viridans", "Penicillin": 0.005, "Streptomycin": 10.0, "Neomycin": 40.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</section>
<section id="discussion-questions" class="level2">
<h2 class="anchored" data-anchor-id="discussion-questions">Discussion questions</h2>
<p>Examples III and IV are jury-rigged to work nicely. They work because</p>
<ul>
<li>legend is ordered alphabetically</li>
<li>bacteria family is at the beginning of the name of each strain.</li>
</ul>
<p>Suppose instead that the family was instead at the <em>end</em> of the name</p>
<table class="table">
<thead>
<tr class="header">
<th>bacteria name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Viridans, streptococcus</td>
</tr>
<tr class="even">
<td>Hemolycticus, Streptococcus</td>
</tr>
</tbody>
</table>
<p>Let’s troubleshoot in real-time. How would you get the color scheme to align with family? There’s more than one good way to do this.</p>
<div class="notes">
<p><strong>NOTES:</strong> <em>solution 1) (less clever) manually assign colors to each strain by hand 2) (more clever) use string cleaning to move the family name to the front. 3) (not sure exactly how to do this in Python, but this is how I’d do it in Stata) assign each bacteria to a number, making sure bacteria in the same family are close to each other. Then just use the name as a label for the legend</em></p>
</div>
</section>
<section id="text-labels-by-species" class="level2">
<h2 class="anchored" data-anchor-id="text-labels-by-species">Text Labels by Species</h2>
<p>A more clear way to handle this is to use <code>mark_text()</code> to explicitly label each dot. However, that comes at the cost of adding a lot of chart clutter.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>base <span class="op">=</span> alt.Chart(antibiotics).mark_circle(size<span class="op">=</span><span class="dv">80</span>).encode(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    alt.X(<span class="st">'Penicillin:Q'</span>,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>, domain<span class="op">=</span>[<span class="fl">0.001</span>, <span class="dv">1000</span>]),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>          axis<span class="op">=</span>alt.Axis(tickCount<span class="op">=</span><span class="dv">5</span>),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Penicillin MIC (μg/ml) --- more effective →'</span>),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    alt.Y(<span class="st">'Streptomycin:Q'</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>, domain<span class="op">=</span>[<span class="fl">0.001</span>, <span class="dv">1000</span>]),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>          axis<span class="op">=</span>alt.Axis(tickCount<span class="op">=</span><span class="dv">5</span>),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'Streptomycin MIC (μg/ml, reverse log scale)'</span>),</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    alt.Color(<span class="st">'Bacteria:N'</span>, legend<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>).properties(width<span class="op">=</span><span class="dv">250</span>, height<span class="op">=</span><span class="dv">250</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Add text labels next to each dot</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> base.mark_text(</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    align<span class="op">=</span><span class="st">'left'</span>,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    baseline<span class="op">=</span><span class="st">'middle'</span>,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    dx<span class="op">=</span><span class="dv">7</span>,  <span class="co"># Adjust the position of the text</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    dy<span class="op">=-</span><span class="dv">5</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>).encode(</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    text<span class="op">=</span><span class="st">'Bacteria:O'</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the base chart with the text labels</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>chart <span class="op">=</span> base <span class="op">+</span> text</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>chart</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">

<style>
  #altair-viz-cca4afacaa4248ae90da6b3cbe4edfb9.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-cca4afacaa4248ae90da6b3cbe4edfb9.vega-embed details,
  #altair-viz-cca4afacaa4248ae90da6b3cbe4edfb9.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-cca4afacaa4248ae90da6b3cbe4edfb9"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-cca4afacaa4248ae90da6b3cbe4edfb9") {
      outputDiv = document.getElementById("altair-viz-cca4afacaa4248ae90da6b3cbe4edfb9");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "layer": [{"mark": {"type": "circle", "size": 80}, "encoding": {"color": {"field": "Bacteria", "legend": null, "type": "nominal"}, "x": {"axis": {"tickCount": 5}, "field": "Penicillin", "scale": {"domain": [0.001, 1000], "type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Penicillin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}, "y": {"axis": {"tickCount": 5}, "field": "Streptomycin", "scale": {"domain": [0.001, 1000], "type": "log"}, "title": "Streptomycin MIC (\u03bcg/ml, reverse log scale)", "type": "quantitative"}}}, {"mark": {"type": "text", "align": "left", "baseline": "middle", "dx": 7, "dy": -5}, "encoding": {"color": {"field": "Bacteria", "legend": null, "type": "nominal"}, "text": {"field": "Bacteria", "type": "ordinal"}, "x": {"axis": {"tickCount": 5}, "field": "Penicillin", "scale": {"domain": [0.001, 1000], "type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Penicillin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}, "y": {"axis": {"tickCount": 5}, "field": "Streptomycin", "scale": {"domain": [0.001, 1000], "type": "log"}, "title": "Streptomycin MIC (\u03bcg/ml, reverse log scale)", "type": "quantitative"}}}], "data": {"name": "data-9358c74bfa85e269e603e741ba1c4924"}, "height": 250, "width": 250, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-9358c74bfa85e269e603e741ba1c4924": [{"Bacteria": "Aerobacter aerogenes", "Penicillin": 870.0, "Streptomycin": 1.0, "Neomycin": 1.6, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Bacillus anthracis", "Penicillin": 0.001, "Streptomycin": 0.01, "Neomycin": 0.007, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Brucella abortus", "Penicillin": 1.0, "Streptomycin": 2.0, "Neomycin": 0.02, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Diplococcus pneumoniae", "Penicillin": 0.005, "Streptomycin": 11.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Escherichia coli", "Penicillin": 100.0, "Streptomycin": 0.4, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Klebsiella pneumoniae", "Penicillin": 850.0, "Streptomycin": 1.2, "Neomycin": 1.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Mycobacterium tuberculosis", "Penicillin": 800.0, "Streptomycin": 5.0, "Neomycin": 2.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Proteus vulgaris", "Penicillin": 3.0, "Streptomycin": 0.1, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Pseudomonas aeruginosa", "Penicillin": 850.0, "Streptomycin": 2.0, "Neomycin": 0.4, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Salmonella (Eberthella) typhosa", "Penicillin": 1.0, "Streptomycin": 0.4, "Neomycin": 0.008, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Salmonella schottmuelleri", "Penicillin": 10.0, "Streptomycin": 0.8, "Neomycin": 0.09, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Staphylococcus albus", "Penicillin": 0.007, "Streptomycin": 0.1, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Staphylococcus aureus", "Penicillin": 0.03, "Streptomycin": 0.03, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Streptococcus fecalis", "Penicillin": 1.0, "Streptomycin": 1.0, "Neomycin": 0.1, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus hemolyticus", "Penicillin": 0.001, "Streptomycin": 14.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus viridans", "Penicillin": 0.005, "Streptomycin": 10.0, "Neomycin": 40.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<p>Discussion question – What is another way we have seen to make it possible for the reader to see what each dot is labeled, but using less clutter?</p>
<div class="notes">
<p><strong>NOTES:</strong> <em>solution tool tip</em></p>
</div>
</section>
<section id="color-by-genus-i" class="level2">
<h2 class="anchored" data-anchor-id="color-by-genus-i">Color by Genus I</h2>
<p>Need to use <code>transform_calculate()</code> to extract <code>Genus</code></p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>alt.Chart(antibiotics).mark_circle(size<span class="op">=</span><span class="dv">80</span>).transform_calculate(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    Genus<span class="op">=</span><span class="st">'split(datum.Bacteria, " ")[0]'</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>).encode(</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    alt.X(<span class="st">'Neomycin:Q'</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>, domain<span class="op">=</span>[<span class="fl">0.001</span>, <span class="dv">1000</span>]),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>          axis<span class="op">=</span>alt.Axis(tickCount<span class="op">=</span><span class="dv">5</span>),</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Neomycin MIC (μg/ml) --- more effective →'</span>),</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    alt.Y(<span class="st">'Penicillin:Q'</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>, domain<span class="op">=</span>[<span class="fl">0.001</span>, <span class="dv">1000</span>]),</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>          axis<span class="op">=</span>alt.Axis(tickCount<span class="op">=</span><span class="dv">5</span>),</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Penicillin MIC (μg/ml) --- more effective →'</span>),</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    alt.Color(<span class="st">'Genus:N'</span>,</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(scheme<span class="op">=</span><span class="st">'tableau20'</span>))</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>).properties(width<span class="op">=</span><span class="dv">250</span>, height<span class="op">=</span><span class="dv">250</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">


<style>
  #altair-viz-83712c1d3b6a4600b87891adde1be547.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-83712c1d3b6a4600b87891adde1be547.vega-embed details,
  #altair-viz-83712c1d3b6a4600b87891adde1be547.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-83712c1d3b6a4600b87891adde1be547"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-83712c1d3b6a4600b87891adde1be547") {
      outputDiv = document.getElementById("altair-viz-83712c1d3b6a4600b87891adde1be547");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-9358c74bfa85e269e603e741ba1c4924"}, "mark": {"type": "circle", "size": 80}, "encoding": {"color": {"field": "Genus", "scale": {"scheme": "tableau20"}, "type": "nominal"}, "x": {"axis": {"tickCount": 5}, "field": "Neomycin", "scale": {"domain": [0.001, 1000], "type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Neomycin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}, "y": {"axis": {"tickCount": 5}, "field": "Penicillin", "scale": {"domain": [0.001, 1000], "type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Penicillin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}}, "height": 250, "transform": [{"calculate": "split(datum.Bacteria, \" \")[0]", "as": "Genus"}], "width": 250, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-9358c74bfa85e269e603e741ba1c4924": [{"Bacteria": "Aerobacter aerogenes", "Penicillin": 870.0, "Streptomycin": 1.0, "Neomycin": 1.6, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Bacillus anthracis", "Penicillin": 0.001, "Streptomycin": 0.01, "Neomycin": 0.007, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Brucella abortus", "Penicillin": 1.0, "Streptomycin": 2.0, "Neomycin": 0.02, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Diplococcus pneumoniae", "Penicillin": 0.005, "Streptomycin": 11.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Escherichia coli", "Penicillin": 100.0, "Streptomycin": 0.4, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Klebsiella pneumoniae", "Penicillin": 850.0, "Streptomycin": 1.2, "Neomycin": 1.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Mycobacterium tuberculosis", "Penicillin": 800.0, "Streptomycin": 5.0, "Neomycin": 2.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Proteus vulgaris", "Penicillin": 3.0, "Streptomycin": 0.1, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Pseudomonas aeruginosa", "Penicillin": 850.0, "Streptomycin": 2.0, "Neomycin": 0.4, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Salmonella (Eberthella) typhosa", "Penicillin": 1.0, "Streptomycin": 0.4, "Neomycin": 0.008, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Salmonella schottmuelleri", "Penicillin": 10.0, "Streptomycin": 0.8, "Neomycin": 0.09, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Staphylococcus albus", "Penicillin": 0.007, "Streptomycin": 0.1, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Staphylococcus aureus", "Penicillin": 0.03, "Streptomycin": 0.03, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Streptococcus fecalis", "Penicillin": 1.0, "Streptomycin": 1.0, "Neomycin": 0.1, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus hemolyticus", "Penicillin": 0.001, "Streptomycin": 14.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus viridans", "Penicillin": 0.005, "Streptomycin": 10.0, "Neomycin": 40.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</section>
<section id="color-by-genus-ii" class="level2">
<h2 class="anchored" data-anchor-id="color-by-genus-ii">Color by Genus II</h2>
<p>Recode infrequent <code>Genus</code> values to “Other”.</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>alt.Chart(antibiotics).mark_circle(size<span class="op">=</span><span class="dv">80</span>).transform_calculate(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  Split<span class="op">=</span><span class="st">'split(datum.Bacteria, " ")[0]'</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>).transform_calculate(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  Genus<span class="op">=</span><span class="st">'indexof(["Salmonella", "Staphylococcus", "Streptococcus"], datum.Split) &gt;= 0 ? datum.Split : "Other"'</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>).encode(</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    alt.X(<span class="st">'Neomycin:Q'</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>, domain<span class="op">=</span>[<span class="fl">0.001</span>, <span class="dv">1000</span>]),</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>          axis<span class="op">=</span>alt.Axis(tickCount<span class="op">=</span><span class="dv">5</span>),</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Neomycin MIC (μg/ml) --- more effective →'</span>),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    alt.Y(<span class="st">'Penicillin:Q'</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>          sort<span class="op">=</span><span class="st">'descending'</span>,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>, domain<span class="op">=</span>[<span class="fl">0.001</span>, <span class="dv">1000</span>]),</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>          axis<span class="op">=</span>alt.Axis(tickCount<span class="op">=</span><span class="dv">5</span>),</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>          title<span class="op">=</span><span class="st">'← Less effective --- Penicillin MIC (μg/ml) --- more effective →'</span>),</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    alt.Color(<span class="st">'Genus:N'</span>,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>          scale<span class="op">=</span>alt.Scale(</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>            domain<span class="op">=</span>[<span class="st">'Salmonella'</span>, <span class="st">'Staphylococcus'</span>, <span class="st">'Streptococcus'</span>, <span class="st">'Other'</span>],</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>            <span class="bu">range</span><span class="op">=</span>[<span class="st">'rgb(76,120,168)'</span>, <span class="st">'rgb(84,162,75)'</span>, <span class="st">'rgb(228,87,86)'</span>, <span class="st">'rgb(121,112,110)'</span>]</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>          ))</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>).properties(width<span class="op">=</span><span class="dv">250</span>, height<span class="op">=</span><span class="dv">250</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">

<style>
  #altair-viz-1841f20456c44cee90dfc562f3a3c9f5.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-1841f20456c44cee90dfc562f3a3c9f5.vega-embed details,
  #altair-viz-1841f20456c44cee90dfc562f3a3c9f5.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-1841f20456c44cee90dfc562f3a3c9f5"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-1841f20456c44cee90dfc562f3a3c9f5") {
      outputDiv = document.getElementById("altair-viz-1841f20456c44cee90dfc562f3a3c9f5");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-9358c74bfa85e269e603e741ba1c4924"}, "mark": {"type": "circle", "size": 80}, "encoding": {"color": {"field": "Genus", "scale": {"domain": ["Salmonella", "Staphylococcus", "Streptococcus", "Other"], "range": ["rgb(76,120,168)", "rgb(84,162,75)", "rgb(228,87,86)", "rgb(121,112,110)"]}, "type": "nominal"}, "x": {"axis": {"tickCount": 5}, "field": "Neomycin", "scale": {"domain": [0.001, 1000], "type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Neomycin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}, "y": {"axis": {"tickCount": 5}, "field": "Penicillin", "scale": {"domain": [0.001, 1000], "type": "log"}, "sort": "descending", "title": "\u2190 Less effective --- Penicillin MIC (\u03bcg/ml) --- more effective \u2192", "type": "quantitative"}}, "height": 250, "transform": [{"calculate": "split(datum.Bacteria, \" \")[0]", "as": "Split"}, {"calculate": "indexof([\"Salmonella\", \"Staphylococcus\", \"Streptococcus\"], datum.Split) >= 0 ? datum.Split : \"Other\"", "as": "Genus"}], "width": 250, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-9358c74bfa85e269e603e741ba1c4924": [{"Bacteria": "Aerobacter aerogenes", "Penicillin": 870.0, "Streptomycin": 1.0, "Neomycin": 1.6, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Bacillus anthracis", "Penicillin": 0.001, "Streptomycin": 0.01, "Neomycin": 0.007, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Brucella abortus", "Penicillin": 1.0, "Streptomycin": 2.0, "Neomycin": 0.02, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Diplococcus pneumoniae", "Penicillin": 0.005, "Streptomycin": 11.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Escherichia coli", "Penicillin": 100.0, "Streptomycin": 0.4, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Klebsiella pneumoniae", "Penicillin": 850.0, "Streptomycin": 1.2, "Neomycin": 1.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Mycobacterium tuberculosis", "Penicillin": 800.0, "Streptomycin": 5.0, "Neomycin": 2.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Proteus vulgaris", "Penicillin": 3.0, "Streptomycin": 0.1, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Pseudomonas aeruginosa", "Penicillin": 850.0, "Streptomycin": 2.0, "Neomycin": 0.4, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Salmonella (Eberthella) typhosa", "Penicillin": 1.0, "Streptomycin": 0.4, "Neomycin": 0.008, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Salmonella schottmuelleri", "Penicillin": 10.0, "Streptomycin": 0.8, "Neomycin": 0.09, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Staphylococcus albus", "Penicillin": 0.007, "Streptomycin": 0.1, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Staphylococcus aureus", "Penicillin": 0.03, "Streptomycin": 0.03, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Streptococcus fecalis", "Penicillin": 1.0, "Streptomycin": 1.0, "Neomycin": 0.1, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus hemolyticus", "Penicillin": 0.001, "Streptomycin": 14.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus viridans", "Penicillin": 0.005, "Streptomycin": 10.0, "Neomycin": 40.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<p>Remark: the <code>antibiotics</code> dataset actually already comes with a column called <code>Genus</code> but the textbook recreates it in the code block above in order to show you how to add categories as part of a single code block in vega.</p>
</section>
<section id="color-by-antibiotic-response-i" class="level2">
<h2 class="anchored" data-anchor-id="color-by-antibiotic-response-i">Color by Antibiotic Response I</h2>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>alt.Chart(antibiotics).mark_rect().encode(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    alt.Y(<span class="st">'Bacteria:N'</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>      sort<span class="op">=</span>alt.EncodingSortField(field<span class="op">=</span><span class="st">'Penicillin'</span>, op<span class="op">=</span><span class="st">'max'</span>, order<span class="op">=</span><span class="st">'descending'</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    alt.Color(<span class="st">'Penicillin:Q'</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">

<style>
  #altair-viz-0929b69588b04fa29b9e96ac9553e68b.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-0929b69588b04fa29b9e96ac9553e68b.vega-embed details,
  #altair-viz-0929b69588b04fa29b9e96ac9553e68b.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-0929b69588b04fa29b9e96ac9553e68b"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-0929b69588b04fa29b9e96ac9553e68b") {
      outputDiv = document.getElementById("altair-viz-0929b69588b04fa29b9e96ac9553e68b");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-9358c74bfa85e269e603e741ba1c4924"}, "mark": {"type": "rect"}, "encoding": {"color": {"field": "Penicillin", "type": "quantitative"}, "y": {"field": "Bacteria", "sort": {"field": "Penicillin", "op": "max", "order": "descending"}, "type": "nominal"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-9358c74bfa85e269e603e741ba1c4924": [{"Bacteria": "Aerobacter aerogenes", "Penicillin": 870.0, "Streptomycin": 1.0, "Neomycin": 1.6, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Bacillus anthracis", "Penicillin": 0.001, "Streptomycin": 0.01, "Neomycin": 0.007, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Brucella abortus", "Penicillin": 1.0, "Streptomycin": 2.0, "Neomycin": 0.02, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Diplococcus pneumoniae", "Penicillin": 0.005, "Streptomycin": 11.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Escherichia coli", "Penicillin": 100.0, "Streptomycin": 0.4, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Klebsiella pneumoniae", "Penicillin": 850.0, "Streptomycin": 1.2, "Neomycin": 1.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Mycobacterium tuberculosis", "Penicillin": 800.0, "Streptomycin": 5.0, "Neomycin": 2.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Proteus vulgaris", "Penicillin": 3.0, "Streptomycin": 0.1, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Pseudomonas aeruginosa", "Penicillin": 850.0, "Streptomycin": 2.0, "Neomycin": 0.4, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Salmonella (Eberthella) typhosa", "Penicillin": 1.0, "Streptomycin": 0.4, "Neomycin": 0.008, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Salmonella schottmuelleri", "Penicillin": 10.0, "Streptomycin": 0.8, "Neomycin": 0.09, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Staphylococcus albus", "Penicillin": 0.007, "Streptomycin": 0.1, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Staphylococcus aureus", "Penicillin": 0.03, "Streptomycin": 0.03, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Streptococcus fecalis", "Penicillin": 1.0, "Streptomycin": 1.0, "Neomycin": 0.1, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus hemolyticus", "Penicillin": 0.001, "Streptomycin": 14.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus viridans", "Penicillin": 0.005, "Streptomycin": 10.0, "Neomycin": 40.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</section>
<section id="color-by-antibiotic-response-ii" class="level2">
<h2 class="anchored" data-anchor-id="color-by-antibiotic-response-ii">Color by Antibiotic Response II</h2>
<p>Cosmetic improvements:</p>
<ul>
<li>add plot title</li>
<li>format <code>alt.Y(... alt.Axis())</code></li>
<li>format <code>alt.Color</code> with <code>plasma</code> color scheme, legend edits</li>
</ul>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>alt.Chart(antibiotics, title<span class="op">=</span><span class="st">'Penicillin Resistance of Bacterial Strains'</span>).mark_rect().encode(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    alt.Y(<span class="st">'Bacteria:N'</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>      sort<span class="op">=</span>alt.EncodingSortField(field<span class="op">=</span><span class="st">'Penicillin'</span>, op<span class="op">=</span><span class="st">'max'</span>, order<span class="op">=</span><span class="st">'descending'</span>),</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>      axis<span class="op">=</span>alt.Axis(</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>        orient<span class="op">=</span><span class="st">'right'</span>,     <span class="co"># orient axis on right side of chart</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>        titleX<span class="op">=</span><span class="dv">7</span>,           <span class="co"># set x-position to 7 pixels right of chart</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>        titleY<span class="op">=-</span><span class="dv">2</span>,          <span class="co"># set y-position to 2 pixels above chart</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>        titleAlign<span class="op">=</span><span class="st">'left'</span>,  <span class="co"># use left-aligned text</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        titleAngle<span class="op">=</span><span class="dv">0</span>        <span class="co"># undo default title rotation</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    alt.Color(<span class="st">'Penicillin:Q'</span>,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>      scale<span class="op">=</span>alt.Scale(<span class="bu">type</span><span class="op">=</span><span class="st">'log'</span>, scheme<span class="op">=</span><span class="st">'plasma'</span>, nice<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>      legend<span class="op">=</span>alt.Legend(titleOrient<span class="op">=</span><span class="st">'right'</span>, tickCount<span class="op">=</span><span class="dv">5</span>),</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>      title<span class="op">=</span><span class="st">'Penicillin MIC (μg/ml)'</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>).configure_title(</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  anchor<span class="op">=</span><span class="st">'start'</span>, <span class="co"># anchor and left-align title</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  offset<span class="op">=</span><span class="dv">5</span>        <span class="co"># set title offset from chart</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">

<style>
  #altair-viz-96dc22de8ea34f15a62d4dfe93b388a8.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-96dc22de8ea34f15a62d4dfe93b388a8.vega-embed details,
  #altair-viz-96dc22de8ea34f15a62d4dfe93b388a8.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-96dc22de8ea34f15a62d4dfe93b388a8"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-96dc22de8ea34f15a62d4dfe93b388a8") {
      outputDiv = document.getElementById("altair-viz-96dc22de8ea34f15a62d4dfe93b388a8");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}, "title": {"anchor": "start", "offset": 5}}, "data": {"name": "data-9358c74bfa85e269e603e741ba1c4924"}, "mark": {"type": "rect"}, "encoding": {"color": {"field": "Penicillin", "legend": {"tickCount": 5, "titleOrient": "right"}, "scale": {"nice": true, "scheme": "plasma", "type": "log"}, "title": "Penicillin MIC (\u03bcg/ml)", "type": "quantitative"}, "y": {"axis": {"orient": "right", "titleAlign": "left", "titleAngle": 0, "titleX": 7, "titleY": -2}, "field": "Bacteria", "sort": {"field": "Penicillin", "op": "max", "order": "descending"}, "type": "nominal"}}, "title": "Penicillin Resistance of Bacterial Strains", "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-9358c74bfa85e269e603e741ba1c4924": [{"Bacteria": "Aerobacter aerogenes", "Penicillin": 870.0, "Streptomycin": 1.0, "Neomycin": 1.6, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Bacillus anthracis", "Penicillin": 0.001, "Streptomycin": 0.01, "Neomycin": 0.007, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Brucella abortus", "Penicillin": 1.0, "Streptomycin": 2.0, "Neomycin": 0.02, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Diplococcus pneumoniae", "Penicillin": 0.005, "Streptomycin": 11.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "other"}, {"Bacteria": "Escherichia coli", "Penicillin": 100.0, "Streptomycin": 0.4, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Klebsiella pneumoniae", "Penicillin": 850.0, "Streptomycin": 1.2, "Neomycin": 1.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Mycobacterium tuberculosis", "Penicillin": 800.0, "Streptomycin": 5.0, "Neomycin": 2.0, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Proteus vulgaris", "Penicillin": 3.0, "Streptomycin": 0.1, "Neomycin": 0.1, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Pseudomonas aeruginosa", "Penicillin": 850.0, "Streptomycin": 2.0, "Neomycin": 0.4, "Gram_Staining": "negative", "Genus": "other"}, {"Bacteria": "Salmonella (Eberthella) typhosa", "Penicillin": 1.0, "Streptomycin": 0.4, "Neomycin": 0.008, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Salmonella schottmuelleri", "Penicillin": 10.0, "Streptomycin": 0.8, "Neomycin": 0.09, "Gram_Staining": "negative", "Genus": "Salmonella"}, {"Bacteria": "Staphylococcus albus", "Penicillin": 0.007, "Streptomycin": 0.1, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Staphylococcus aureus", "Penicillin": 0.03, "Streptomycin": 0.03, "Neomycin": 0.001, "Gram_Staining": "positive", "Genus": "Staphylococcus"}, {"Bacteria": "Streptococcus fecalis", "Penicillin": 1.0, "Streptomycin": 1.0, "Neomycin": 0.1, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus hemolyticus", "Penicillin": 0.001, "Streptomycin": 14.0, "Neomycin": 10.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}, {"Bacteria": "Streptococcus viridans", "Penicillin": 0.005, "Streptomycin": 10.0, "Neomycin": 40.0, "Gram_Staining": "positive", "Genus": "Streptococcus"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</section>
<section id="configuring-color-legends-summary" class="level2">
<h2 class="anchored" data-anchor-id="configuring-color-legends-summary">Configuring Color Legends: summary</h2>
<ul>
<li>Overarching idea: visualization as a tool for discovery</li>
<li>Avoid
<ul>
<li>Too many groups in a legend</li>
<li>Colors that are too similar for groups that are actually dissimilar (e.g.&nbsp;when the underlying variable is <code>N</code>ominal)<br>
</li>
</ul></li>
<li>Strive to
<ul>
<li>Choose colors with external meaning (e.g.&nbsp;gram staining)</li>
<li>Construct categorical variables (e.g.&nbsp;<code>Genus</code>)</li>
<li>If you must have many categories, put annotation directly next to dots or create an interactive plot with a tooltip.</li>
<li>Choose colors that are easy to discern (e.g.&nbsp;<code>viridis</code>, <code>plasma</code>)</li>
</ul></li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>